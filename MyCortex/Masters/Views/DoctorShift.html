<head>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css'>
    <link rel='stylesheet' href='https://bootstrap-tagsinput.github.io/bootstrap-tagsinput/dist/bootstrap-tagsinput.css'>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link href="//db.onlinewebfonts.com/c/157c6cc36dd65b1b2adc9e7f3329c761?family=Amazon+Ember" rel="stylesheet" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    <link href="../../Css/theme.css" rel="stylesheet">
</head>

<ul class="secondaryMenu">
    <!--<li><a href="Home/Index#/MyAppointmentSetting">Organization Settings</a></li>
    <li><a href="Home/Index#/AppointmentSlot">Appointment Slot</a></li>
    <li><a href="Home/Index#/SlotTiming">Shift Timing</a></li>
    <li><a href="Home/Index#/DoctorShift" data-menu="Appointment Setting" class="secondaryMenuActive">Doctor Shift</a></li>
    <li><a href="Home/Index#/DoctorHoliday">Doctor Holiday</a></li>-->
    <li><a href="Home/Index#/AppointmentSlot">Appointment Slot</a></li>
    <li><a href="Home/Index#/SlotTiming">Shift Timing</a></li>
    <li><a href="Home/Index#/DoctorShift"  class="secondaryMenuActive" data-menu="Appointment Setting">Doctor Shift</a></li>
    <li><a href="Home/Index#/DoctorHoliday">Doctor Holiday</a></li>
    <li><a href="Home/Index#/MyAppointmentSetting">Organization Settings</a></li>
</ul>
<h1 class="page-title">Doctor Shift</h1>
<div ng-init="DoctorShiftListGo()">

    <div class="lds-ripple" id="chatLoaderPV" style="display: none;z-index:10000">
        <div></div>
        <div></div>
    </div>
    <div class="panel panel-default" id="DMid">
        <form role="form" class="panel-body">
            <div class="col-sm-4">
                <div class="inputGroups">
                    <label>Search</label>
                    <div class="modernSearch">
                        <input type="text" ng-model="searchquery" ng-change="filterDoctorShiftList()" placeholder=""
                               style="width: 200px" />
                        <i class="fa fa-search"></i>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="inputGroups">
                    <label for="Active">Active</label>
                    <input toggle-checkbox ng-model="IsActive" type="checkbox" ng-change="DoctorShiftListGo();"
                           title="Active / All">
                </div>
            </div>
            <div class="col-sm-4">
                <div class="inputGroups">
                    <a href="javascript:" ng-click="DoctorShiftClear();AddSlot();" class="theme-btn-1 pull-right mt-15"
                       title="Click to Add New Drug DB">Add New</a>
                </div>
            </div>

        </form>
    </div>

    <table st-table="emptydata" style="width: 100%" st-safe-src="rowCollectionFilter" st-search="query"
           class="table themeTable">
        <thead>
            <tr style="text-align: center">
                <th st-ratio="5">#</th>
                <th st-ratio="10" st-sort="Generic_Name">Doctor</th>
                <th st-ratio="8" st-sort="WeekDayName">Week Day Name</th>
                <th st-ratio="8" st-sort="ShiftName">Shift Name</th>
                <!-- <th st-ratio="8" st-sort="StrengthName">Sun</th>
                    <th st-ratio="8" st-sort="Dosage_FromName">Mon</th>
                    <th st-ratio="8" st-sort="StrengthName">Tue</th>
                    <th st-ratio="8" st-sort="Dosage_FromName">Wed</th>
                    <th st-ratio="8" st-sort="StrengthName">Thu</th>
                    <th st-ratio="8" st-sort="Dosage_FromName">Fri</th>
                    <th st-ratio="8" st-sort="Dosage_FromName">Sat</th>-->
                <th st-ratio="8" st-sort="FromDate">From Date</th>
                <th st-ratio="8" st-sort="ToDate">To Date</th>
                <th st-ratio="8">Action</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-if="flag==0 && rowCollectionFilter.length==0">
                <td colspan="15" style="text-align: center">
                    No Data Available
                </td>
            </tr>
            <tr ng-repeat="row in emptydata">
                <td class="textalign">{{((current_page-1)*page_size)+$index+1}}</td>

                <td style="text-align: left">
                    <div class="textwrap">{{row.Doctor_Name}}</div>
                </td>
                <td style="text-align:left">{{row.WeekDayName}}</td>
                <td style="text-align:left">{{row.ShiftName}}</td>
                <!--  <td style="text-align: left">{{SundayShift2}}
                 </td>
                <td style="text-align: left">{{MondayShift2}}
                 </td>
                       <td style="text-align: left">{{TuesdayShift2}}
                 </td>
                       <td style="text-align: left">{{WednessdayShift2}}
                 </td>
                       <td style="text-align: left">{{ThursdayShift2}}
                 </td>
                       <td style="text-align: left">{{FridayShift2}}
                 </td>
                       <td style="text-align: left">{{SaturdayShift2}}
                 </td>-->

                <td style="text-align: left">
                    {{row.FromDate | date:'dd-MMM-yyyy '}}
                </td>
                <td style="text-align: left">
                    {{row.ToDate | date:'dd-MMM-yyyy '}}
                </td>
                <td style="text-align: center">
                    <a href="javascript:" ng-click="ViewDoctorShift(row.Id,row.Doctor_Id)" title="View">
                        <i class="fa fa-eye" aria-hidden="true"></i>
                    </a>
                    <a href="javascript:" title="Edit" ng-click="EditDoctorShift(row.Id, row.IsActive,row.Doctor_Id)">
                        <i class="fa fa-pencil" aria-hidden="true"></i>
                    </a>
                    <a href="javascript:;" ng-click="DeleteDoctorShift(row.Id)" title="Active">
                        <i class="fa fa-check-circle-o" aria-hidden="true" ng-if="row.IsActive==1"></i>

                        <a href="javascript:" ng-click="ReInsertDoctorShift(row.Id,row.Doctor_Id)" title="Inactive">
                            <i class="fa fa-times-circle-o" aria-hidden="true" ng-if="row.IsActive==0"></i>

                        </a>
                </td>
            </tr>
        </tbody>
        <tfoot ng-show="rowCollectionFilter.length >10">
            <tr>
                <td colspan="15" class="text-center">
                    <div st-items-by-page="10" st-page-change="rembemberCurrentPage(newPage)" st-pagination=""
                         st-template="Masters/Views/pagination.custom.html"></div>
                </td>
            </tr>
        </tfoot>
    </table>

</div>

<div id="DoctorShiftModal" class="modal fade-scale" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content" style="width: 280%; right: 90%;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" title="Close"
                        ng-click="CancelPopup()">
                    &times;
                </button>
                <h4 class="modal-title">Doctor Shift</h4>
            </div>
            <div class="modal-body">
                <div class="col-sm-2 p-0">
                    <div class="main-tab">
                        <ul class="tabs">
                            <li class="tab-link current" data-tab="tab-1">STEP 1:<p>Select Doctors &amp; <br>Date Range</p></li>
                            <li class="tab-link" data-tab="tab-2">STEP 2:<p>Set Appointments<br> Slots</p></li>
                            <li class="tab-link" data-tab="tab-3">STEP 3:<p>Weekdays and <br>Shift time</p></li>
                        </ul>
                    </div>
                </div>

                <div class="col-sm-10 p-0">
                    <div id="tab-1" class="tab-content current">
                        <div class="tab-body">
                            <div class="bs-example">
                                <p class="sub-title">Select Specialities</p>
                                <input type="text" name="tags" value="Anesthesiology, Dermatology, Neurology" data-role="tagsinput">
                            </div>
                            <div class="d-flex mt-4">
                                <div class="col-sm-5">
                                    <p class="sub-title">Select Doctor</p>
                                    <div class="subject-info-box-1">
                                        <p class="doctor">Available Doctor</p>
                                        <select multiple="multiple" id="lstBox1" class="form-control">
                                            <option value="ajax">Karthiga</option>
                                            <option value="jquery">Vaisanth</option>
                                            <option value="javascript">Vijay</option>
                                            <option value="mootool">kumar</option>
                                        </select>
                                    </div>
                                    <div class="subject-info-arrows text-center">
                                        <input type="button" id="btnAllRight" value=">>" class="btn-select"><br>
                                        <input type="button" id="btnRight" value=">" class="btn-select"><br>
                                        <input type="button" id="btnLeft" value="<" class="btn-select"><br>
                                        <input type="button" id="btnAllLeft" value="<<" class="btn-select">
                                    </div>
                                    <div class="subject-info-box-2">

                                        <p class="doctor">Selected Doctor</p>
                                        <select multiple="multiple" id="lstBox2" class="form-control">
                                            <option value="asp">Madhavan</option>
                                            <option value="c#">Hari</option>
                                            <option value="vb">John</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="col-sm-7">
                                    <p class="sub-title">Select Day Range</p>
                                    <section class="col-sm-12 p-0">
                                        <div class="daterangepicker-container" data-bind="daterangepicker: dateRange, daterangepickerOptions: {standalone: true}"></div>
                                    </section>
                                </div>
                            </div>
                            <div class="bs-example mt-4">
                                <p class="sub-title">Select CC/CG</p>
                                <input type="text" name="tags" value="Karthi, Ram, Vaisanth" data-role="tagsinput">
                            </div>
                        </div>
                        <div class="d-flex justify-content-end">
                            <button class="btn mt-2">SAVE AND CONTINUE</button>
                        </div>
                    </div>
                    <div id="tab-2" class="tab-content">
                        <div class="tab-body">
                            <p class="sub-title">Appointment Slot</p>
                            <div class="d-flex">
                                <div class="col-sm-3">
                                    <input type="checkbox" class="mr-3">Use Org Default
                                </div>
                                <div class="col-sm-9">
                                    <div class="d-flex">
                                        <div class="col-sm-3">
                                            <p>New Appointment</p>
                                            <div class="d-flex align-items-end mt-2">
                                                <input type="text" class="input-size mr-1">
                                                <p>Min</p>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <p>Follow-up Appointment</p>
                                            <div class="d-flex align-items-end mt-2">
                                                <input type="text" class="input-size mr-1">
                                                <p>Min</p>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <p>Interval</p>
                                            <div class="d-flex align-items-end mt-2">
                                                <input type="text" class="input-size mr-1">
                                                <p>Min</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex mt-4">
                                        <div class="col-sm-3">
                                            <p>Custom Slot</p>
                                            <div class="d-flex align-items-end mt-2">
                                                <input type="text" class="input-size mr-1">
                                                <p>Min</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="mt-4">Booking Info</p>
                                <div class="d-flex mt-4">
                                    <div class="col-sm-3">
                                        <input type="checkbox" class="mr-3">Use Org Default
                                    </div>
                                    <div class="col-sm-9 d-flex">
                                        <div class="col-sm-3">
                                            <p>Booking Open</p>
                                            <div class="d-flex align-items-end mt-2">
                                                <input type="text" class="input-size mr-1">
                                                <p>Days</p>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <p>Booking Cancel Lock</p>
                                            <div class="d-flex align-items-end mt-2">
                                                <input type="text" class="input-size mr-1">
                                                <p>Hours</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end">
                            <button class="btn mt-2">SAVE AND CONTINUE</button>
                        </div>
                    </div>
                    <div id="tab-3" class="tab-content">
                        <div class="tab-body">
                            <div class="col-sm-12 p-0">
                                <p class="sub-title">Select Week Days</p>
                                <div class="d-flex col-sm-9">
                                    <div class="mr-3">
                                        <div class="d-flex justify-content-center">
                                            <input type="checkbox" class="input-checkbox" checked="">
                                        </div>
                                        <p class="input-text text-center mt-2">Sunday</p>
                                    </div>
                                    <div class="mr-3">
                                        <div class="d-flex justify-content-center">
                                            <input type="checkbox" class="input-checkbox" checked="">
                                        </div>
                                        <p class="input-text text-center mt-2">Monday</p>
                                    </div>
                                    <div class="mr-3">
                                        <div class="d-flex justify-content-center">
                                            <input type="checkbox" class="input-checkbox" checked="">
                                        </div>
                                        <p class="input-text text-center mt-2">Tuesday</p>
                                    </div>
                                    <div class="mr-3">
                                        <div class="d-flex justify-content-center">
                                            <input type="checkbox" class="input-checkbox" checked="">
                                        </div>
                                        <p class="input-text text-center mt-2">Wednesday</p>
                                    </div>
                                    <div class="mr-3">
                                        <div class="d-flex justify-content-center">
                                            <input type="checkbox" class="input-checkbox" checked="">
                                        </div>
                                        <p class="input-text text-center mt-2">Thursday</p>
                                    </div>
                                    <div class="mr-3">
                                        <div class="d-flex justify-content-center">
                                            <input type="checkbox" class="input-checkbox" checked="">
                                        </div>
                                        <p class="input-text text-center mt-2">Friday</p>
                                    </div>
                                    <div class="">
                                        <div class="d-flex justify-content-center">
                                            <input type="checkbox" class="input-checkbox" checked="">
                                        </div>
                                        <p class="input-text text-center mt-2">Saturday</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 p-0">
                                <p class="sub-title mt-4">Select Time Slot</p>
                                <div class="d-flex col-sm-8">
                                    <div class="col-sm-3">
                                        <p class="shift">Date / Day</p>
                                    </div>
                                    <div class="col-sm-3">
                                        <p class="shift">Shift 1</p>
                                        <div class="d-flex mt-1">
                                            <input type="checkbox" class="mr-1">
                                            <p class="ml-1">Copy to all</p>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <p class="shift">Shift 2</p>
                                        <div class="d-flex mt-1">
                                            <input type="checkbox" class="mr-1">
                                            <p class="ml-1">Copy to all</p>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <p class="shift">Shift 3</p>
                                        <div class="d-flex mt-1">
                                            <input type="checkbox" class="mr-1">
                                            <p class="ml-1">Copy to all</p>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <p class="add-shift"><i class="fa fa-plus mr-1" aria-hidden="true"></i>Add Shift</p>
                                    </div>
                                </div>
                                <div class="col-sm-8 d-flex">
                                    <div class="col-sm-3 mt-2">
                                        <p>Sunday, May 01, 2021</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">8.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">4.00 PM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">4.00 PM</p>
                                        <p class="to">to</p>
                                        <p class="time">12.00 AM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">12.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">8.00 PM</p>
                                    </div>
                                </div>
                                <div class="col-sm-8 d-flex">
                                    <div class="col-sm-3 mt-2">
                                        <p>Monday, May 01, 2021</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">8.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">4.00 PM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">4.00 PM</p>
                                        <p class="to">to</p>
                                        <p class="time">12.00 AM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">12.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">8.00 PM</p>
                                    </div>
                                </div>
                                <div class="col-sm-8 d-flex">
                                    <div class="col-sm-3 mt-2">
                                        <p>Thursday, May 01, 2021</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">8.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">4.00 PM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">4.00 PM</p>
                                        <p class="to">to</p>
                                        <p class="time">12.00 AM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">12.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">8.00 PM</p>
                                    </div>
                                </div>
                                <div class="col-sm-8 d-flex">
                                    <div class="col-sm-3 mt-2">
                                        <p>Friday, May 01, 2021</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">8.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">4.00 PM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">4.00 PM</p>
                                        <p class="to">to</p>
                                        <p class="time">12.00 AM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">12.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">8.00 PM</p>
                                    </div>
                                </div>

                                <div class="col-sm-8 d-flex">
                                    <div class="col-sm-3 mt-2">
                                        <p>Saturday, May 01, 2021</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">8.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">4.00 PM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">4.00 PM</p>
                                        <p class="to">to</p>
                                        <p class="time">12.00 AM</p>
                                    </div>
                                    <div class="col-sm-3 mt-2 d-flex">
                                        <p class="time">12.00 AM</p>
                                        <p class="to">to</p>
                                        <p class="time">8.00 PM</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="p-0 col-sm-12 d-flex justify-content-end">
                            <button class="btn mt-2">SAVE AND CONTINUE</button>
                        </div>
                    </div>
                </div>
            </div>
            <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
            <script src="js/tab.js"></script>
            <script src="js/tag.js"></script>
            <script src="js/script.js"></script>

            <script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.js'></script>
            <!--<script src='https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-debug.js'></script>-->
            <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js'></script>
            <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js'></script>
            <script src='https://bootstrap-tagsinput.github.io/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js'></script>
            <!--<div class="modal-footer" style="text-align:center;">
                <button type="button" class="theme-btn-1 mr-10" ng-click="DoctorShift_AddEdit()"
                        title="Click to Save">
                    Save
                </button>
                <button type="button" class="theme-btn-2" ng-click="CancelSlot()"
                        title="Click to Cancel">
                    Cancel
                </button>
            </div>-->
        </div>
    </div>
</div>

<!--View Modal--->
<div id="ViewDoctorShiftModal" class="modal fade-scale" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" ng-click="CancelPopup()"
                        title="Close">
                    &times;
                </button>
                <h1 class="page-title">Doctor Shift</h1>
            </div>

            <div class="modal-body" id="Div2">


                <form role="form">
                    <div class="inputGroups">
                        <label>Doctor</label>
                        <span> {{Doctor_Name}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>{{day1}}</label>
                        <span>{{SundayShiftview}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>{{day2}}</label>
                        <span> {{MondayShiftview}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>{{day3}}</label>
                        <span> {{TuesdayShiftview}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>{{day4}}</label>
                        <span> {{WednessdayShiftview}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>{{day5}}</label>
                        <span> {{ThursdayShiftview}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>{{day6}}</label>
                        <span> {{FridayShiftview}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>{{day7}}</label>
                        <span>{{SaturdayShiftview}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>
                            From Date
                        </label>
                        <span>  {{FromDate | date:'dd-MMM-yyyy '}}</span>
                    </div>
                    <div class="inputGroups">
                        <label>To Date</label>
                        <span> {{ToDate | date:'dd-MMM-yyyy '}}</span>
                    </div>


                </form>


            </div>
            <div class="modal-footer" style="text-align:center;">
                <button type="button" class="theme-btn-2" title="Click to Cancel"
                        ng-click="CancelDoctorShiftpopup()">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    (function () {
        var AllTimeDateRange, ArrayUtils, CalendarHeaderView, CalendarView, Config, CustomDateRange, DateRange, DateRangePickerView, MomentIterator, MomentUtil, Period,
            extend = function (child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
            hasProp = {}.hasOwnProperty,
            bind = function (fn, me) { return function () { return fn.apply(me, arguments); }; };

        MomentUtil = (function () {
            function MomentUtil() { }

            MomentUtil.patchCurrentLocale = function (obj) {
                return moment.locale(moment.locale(), obj);
            };

            MomentUtil.setFirstDayOfTheWeek = function (dow) {
                var offset;
                if (moment.localeData().firstDayOfWeek() !== dow) {
                    offset = dow - moment.localeData().firstDayOfWeek();
                    return this.patchCurrentLocale({
                        weekdays: ArrayUtils.rotateArray(moment.weekdays(), offset),
                        weekdaysMin: ArrayUtils.rotateArray(moment.weekdaysMin(), offset),
                        weekdaysShort: ArrayUtils.rotateArray(moment.weekdaysShort(), offset),
                        week: {
                            dow: dow,
                            doy: moment.localeData().firstDayOfYear()
                        }
                    });
                }
            };

            MomentUtil.tz = function (input) {
                var args, timeZone;
                args = Array.prototype.slice.call(arguments, 0, -1);
                timeZone = arguments[arguments.length - 1];
                if (moment.tz) {
                    return moment.tz.apply(null, args.concat([timeZone]));
                } else if (timeZone && timeZone.toLowerCase() === 'utc') {
                    return moment.utc.apply(null, args);
                } else {
                    return moment.apply(null, args);
                }
            };

            return MomentUtil;

        })();

        MomentIterator = (function () {
            MomentIterator.array = function (date, amount, period) {
                var i, iterator, j, ref, results;
                iterator = new this(date, period);
                results = [];
                for (i = j = 0, ref = amount - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
                    results.push(iterator.next());
                }
                return results;
            };

            function MomentIterator(date, period) {
                this.date = date.clone();
                this.period = period;
            }

            MomentIterator.prototype.next = function () {
                var nextDate;
                nextDate = this.date;
                this.date = nextDate.clone().add(1, this.period);
                return nextDate.clone();
            };

            return MomentIterator;

        })();

        ArrayUtils = (function () {
            function ArrayUtils() { }

            ArrayUtils.rotateArray = function (array, offset) {
                return array.slice(offset).concat(array.slice(0, offset));
            };

            ArrayUtils.uniqArray = function (array) {
                var i, j, len, newArray;
                newArray = [];
                for (j = 0, len = array.length; j < len; j++) {
                    i = array[j];
                    if (newArray.indexOf(i) === -1) {
                        newArray.push(i);
                    }
                }
                return newArray;
            };

            return ArrayUtils;

        })();

        $.fn.daterangepicker = function (options, callback) {
            if (options == null) {
                options = {};
            }
            this.each(function () {
                var $element;
                $element = $(this);
                if (!$element.data('daterangepicker')) {
                    options.anchorElement = $element;
                    if (callback) {
                        options.callback = callback;
                    }
                    options.callback = $.proxy(options.callback, this);
                    return $element.data('daterangepicker', new DateRangePickerView(options));
                }
            });
            return this;
        };

        ko.bindingHandlers.stopBinding = {
            init: function () {
                return {
                    controlsDescendantBindings: true
                };
            }
        };

        ko.virtualElements.allowedBindings.stopBinding = true;

        ko.bindingHandlers.daterangepicker = (function () {
            return $.extend(this, {
                _optionsKey: 'daterangepickerOptions',
                _formatKey: 'daterangepickerFormat',
                init: function (element, valueAccessor, allBindings) {
                    var observable, options;
                    observable = valueAccessor();
                    options = ko.unwrap(allBindings.get(this._optionsKey)) || {};
                    return $(element).daterangepicker(options, function (startDate, endDate, period) {
                        return observable([startDate, endDate]);
                    });
                },
                update: function (element, valueAccessor, allBindings) {
                    var $element, dateFormat, endDate, endDateText, ref, startDate, startDateText;
                    $element = $(element);
                    ref = valueAccessor()(), startDate = ref[0], endDate = ref[1];
                    dateFormat = ko.unwrap(allBindings.get(this._formatKey)) || 'MMM D, YYYY';
                    startDateText = moment(startDate).format(dateFormat);
                    endDateText = moment(endDate).format(dateFormat);
                    return ko.ignoreDependencies(function () {
                        var text;
                        if (!$element.data('daterangepicker').standalone()) {
                            text = $element.data('daterangepicker').single() ? startDateText : startDateText + " – " + endDateText;
                            $element.val(text).text(text);
                        }
                        $element.data('daterangepicker').startDate(startDate);
                        return $element.data('daterangepicker').endDate(endDate);
                    });
                }
            });
        })();

        DateRange = (function () {
            function DateRange(title, startDate, endDate) {
                this.title = title;
                this.startDate = startDate;
                this.endDate = endDate;
            }

            return DateRange;

        })();

        AllTimeDateRange = (function (superClass) {
            extend(AllTimeDateRange, superClass);

            function AllTimeDateRange() {
                return AllTimeDateRange.__super__.constructor.apply(this, arguments);
            }

            return AllTimeDateRange;

        })(DateRange);

        CustomDateRange = (function (superClass) {
            extend(CustomDateRange, superClass);

            function CustomDateRange() {
                return CustomDateRange.__super__.constructor.apply(this, arguments);
            }

            return CustomDateRange;

        })(DateRange);

        Period = (function () {
            function Period() { }

            Period.allPeriods = ['day', 'week', 'month', 'quarter', 'year'];

            Period.scale = function (period) {
                if (period === 'day' || period === 'week') {
                    return 'month';
                } else {
                    return 'year';
                }
            };

            Period.showWeekDayNames = function (period) {
                if (period === 'day' || period === 'week') {
                    return true;
                } else {
                    return false;
                }
            };

            Period.nextPageArguments = function (period) {
                var amount, scale;
                amount = period === 'year' ? 9 : 1;
                scale = this.scale(period);
                return [amount, scale];
            };

            Period.format = function (period) {
                switch (period) {
                    case 'day':
                    case 'week':
                        return 'D';
                    case 'month':
                        return 'MMM';
                    case 'quarter':
                        return '\\QQ';
                    case 'year':
                        return 'YYYY';
                }
            };

            Period.title = function (period) {
                switch (period) {
                    case 'day':
                        return 'Day';
                    case 'week':
                        return 'Week';
                    case 'month':
                        return 'Month';
                    case 'quarter':
                        return 'Quarter';
                    case 'year':
                        return 'Year';
                }
            };

            Period.dimentions = function (period) {
                switch (period) {
                    case 'day':
                        return [7, 6];
                    case 'week':
                        return [1, 6];
                    case 'month':
                        return [3, 4];
                    case 'quarter':
                        return [2, 2];
                    case 'year':
                        return [3, 3];
                }
            };

            Period.methods = ['scale', 'showWeekDayNames', 'nextPageArguments', 'format', 'title', 'dimentions'];

            Period.extendObservable = function (observable) {
                this.methods.forEach(function (method) {
                    return observable[method] = function () {
                        return Period[method](observable());
                    };
                });
                return observable;
            };

            return Period;

        })();

        Config = (function () {
            function Config(options) {
                if (options == null) {
                    options = {};
                }
                this.firstDayOfWeek = this._firstDayOfWeek(options.firstDayOfWeek);
                this.timeZone = this._timeZone(options.timeZone);
                this.periods = this._periods(options.periods);
                this.period = this._period(options.period);
                this.single = this._single(options.single);
                this.opened = this._opened(options.opened);
                this.expanded = this._expanded(options.expanded);
                this.standalone = this._standalone(options.standalone);
                this.locale = this._locale(options.locale);
                this.orientation = this._orientation(options.orientation);
                this.forceUpdate = options.forceUpdate;
                this.minDate = this._minDate(options.minDate);
                this.maxDate = this._maxDate(options.maxDate);
                this.startDate = this._startDate(options.startDate);
                this.endDate = this._endDate(options.endDate);
                this.ranges = this._ranges(options.ranges);
                this.anchorElement = this._anchorElement(options.anchorElement);
                this.parentElement = this._parentElement(options.parentElement);
                this.callback = this._callback(options.callback);
                this.firstDayOfWeek.subscribe(function (newValue) {
                    return MomentUtil.setFirstDayOfTheWeek(newValue);
                });
                MomentUtil.setFirstDayOfTheWeek(this.firstDayOfWeek());
            }

            Config.prototype.extend = function (obj) {
                var k, results, v;
                results = [];
                for (k in this) {
                    v = this[k];
                    if (this.hasOwnProperty(k) && k[0] !== '_') {
                        results.push(obj[k] = v);
                    }
                }
                return results;
            };

            Config.prototype._firstDayOfWeek = function (val) {
                return ko.observable(val ? val : 0);
            };

            Config.prototype._timeZone = function (val) {
                return ko.observable(val || 'UTC');
            };

            Config.prototype._periods = function (val) {
                return ko.observableArray(val || Period.allPeriods);
            };

            Config.prototype._period = function (val) {
                val || (val = this.periods()[0]);
                if (val !== 'day' && val !== 'week' && val !== 'month' && val !== 'quarter' && val !== 'year') {
                    console.warn("invalid period " + val);
                }
                return Period.extendObservable(ko.observable(val));
            };

            Config.prototype._single = function (val) {
                return ko.observable(val || false);
            };

            Config.prototype._opened = function (val) {
                return ko.observable(val || false);
            };

            Config.prototype._expanded = function (val) {
                return ko.observable(val || false);
            };

            Config.prototype._standalone = function (val) {
                return ko.observable(val || false);
            };

            Config.prototype._minDate = function (val) {
                var mode, ref;
                if (val instanceof Array) {
                    ref = val, val = ref[0], mode = ref[1];
                }
                val || (val = moment().subtract(30, 'years'));
                return this._dateObservable(val, mode);
            };

            Config.prototype._maxDate = function (val) {
                var mode, ref;
                if (val instanceof Array) {
                    ref = val, val = ref[0], mode = ref[1];
                }
                val || (val = moment());
                return this._dateObservable(val, mode, this.minDate);
            };

            Config.prototype._startDate = function (val) {
                val || (val = moment().subtract(29, 'days'));
                return this._dateObservable(val, null, this.minDate, this.maxDate);
            };

            Config.prototype._endDate = function (val) {
                val || (val = moment());
                return this._dateObservable(val, null, this.startDate, this.maxDate);
            };

            Config.prototype._ranges = function (obj) {
                var endDate, from, results, startDate, title, to, value;
                obj || (obj = this._defaultRanges());
                results = [];
                for (title in obj) {
                    value = obj[title];
                    switch (value) {
                        case 'all-time':
                            results.push(new AllTimeDateRange(title, this.minDate().clone(), this.maxDate().clone()));
                            break;
                        case 'custom':
                            results.push(new CustomDateRange(title));
                            break;
                        default:
                            startDate = value[0], endDate = value[1];
                            from = MomentUtil.tz(startDate, this.timeZone());
                            to = MomentUtil.tz(endDate, this.timeZone());
                            results.push(new DateRange(title, from, to));
                    }
                }
                return results;
            };

            Config.prototype._locale = function (val) {
                return val || {
                    applyButtonTitle: 'Apply',
                    cancelButtonTitle: 'Cancel',
                    inputFormat: 'L',
                    startLabel: 'Start',
                    endLabel: 'End'
                };
            };

            Config.prototype._orientation = function (val) {
                if (val !== 'right' && val !== 'left') {
                    val = 'right';
                }
                return ko.observable(val);
            };

            Config.prototype._dateObservable = function (val, mode, minBoundary, maxBoundary) {
                var computed, observable;
                observable = ko.observable();
                computed = ko.computed({
                    read: function () {
                        return observable();
                    },
                    write: (function (_this) {
                        return function (newValue) {
                            var oldValue;
                            newValue = computed.fit(newValue);
                            oldValue = observable();
                            if (!(oldValue && newValue.isSame(oldValue))) {
                                return observable(newValue);
                            }
                        };
                    })(this)
                });
                computed.mode = mode || 'inclusive';
                computed.fit = (function (_this) {
                    return function (val) {
                        var max, min;
                        val = MomentUtil.tz(val, _this.timeZone());
                        if (minBoundary) {
                            min = minBoundary();
                            switch (minBoundary.mode) {
                                case 'extended':
                                    min = min.clone().startOf(_this.period());
                                    break;
                                case 'exclusive':
                                    min = min.clone().endOf(_this.period()).subtract(1, 'millisecond');
                            }
                            val = moment.max(min, val);
                        }
                        if (maxBoundary) {
                            max = maxBoundary();
                            switch (maxBoundary.mode) {
                                case 'extended':
                                    max = max.clone().endOf(_this.period());
                                    break;
                                case 'exclusive':
                                    max = max.clone().startOf(_this.period()).subtract(1, 'millisecond');
                            }
                            val = moment.min(max, val);
                        }
                        return val;
                    };
                })(this);
                computed(val);
                computed.clone = (function (_this) {
                    return function () {
                        return _this._dateObservable(observable(), computed.mode, minBoundary, maxBoundary);
                    };
                })(this);
                computed.isWithinBoundaries = (function (_this) {
                    return function (date) {
                        var between, max, maxExclusive, min, minExclusive, sameMax, sameMin;
                        min = minBoundary();
                        max = maxBoundary();
                        between = date.isBetween(min, max, _this.period());
                        sameMin = date.isSame(min, _this.period());
                        sameMax = date.isSame(max, _this.period());
                        minExclusive = minBoundary.mode === 'exclusive';
                        maxExclusive = maxBoundary.mode === 'exclusive';
                        return between || (!minExclusive && sameMin && !(maxExclusive && sameMax)) || (!maxExclusive && sameMax && !(minExclusive && sameMin));
                    };
                })(this);
                if (minBoundary) {
                    computed.minBoundary = minBoundary;
                    minBoundary.subscribe(function () {
                        return computed(observable());
                    });
                }
                if (maxBoundary) {
                    computed.maxBoundary = maxBoundary;
                    maxBoundary.subscribe(function () {
                        return computed(observable());
                    });
                }
                return computed;
            };

            Config.prototype._defaultRanges = function () {
                return {
                    'Last 30 days': [moment().subtract(29, 'days'), moment()],
                    'Last 90 days': [moment().subtract(89, 'days'), moment()],
                    'Last Year': [moment().subtract(1, 'year').add(1, 'day'), moment()],
                    'All Time': 'all-time',
                    'Custom Range': 'custom'
                };
            };

            Config.prototype._anchorElement = function (val) {
                return $(val);
            };

            Config.prototype._parentElement = function (val) {
                return $(val || (this.standalone() ? this.anchorElement : 'body'));
            };

            Config.prototype._callback = function (val) {
                return val;
            };

            return Config;

        })();

        CalendarHeaderView = (function () {
            function CalendarHeaderView(calendarView) {
                this.clickNextButton = bind(this.clickNextButton, this);
                this.clickPrevButton = bind(this.clickPrevButton, this);
                this.currentDate = calendarView.currentDate;
                this.period = calendarView.period;
                this.timeZone = calendarView.timeZone;
                this.firstDate = calendarView.firstDate;
                this.firstYearOfDecade = calendarView.firstYearOfDecade;
                this.prevDate = ko.pureComputed((function (_this) {
                    return function () {
                        var amount, period, ref;
                        ref = _this.period.nextPageArguments(), amount = ref[0], period = ref[1];
                        return _this.currentDate().clone().subtract(amount, period);
                    };
                })(this));
                this.nextDate = ko.pureComputed((function (_this) {
                    return function () {
                        var amount, period, ref;
                        ref = _this.period.nextPageArguments(), amount = ref[0], period = ref[1];
                        return _this.currentDate().clone().add(amount, period);
                    };
                })(this));
                this.selectedMonth = ko.computed({
                    read: (function (_this) {
                        return function () {
                            return _this.currentDate().month();
                        };
                    })(this),
                    write: (function (_this) {
                        return function (newValue) {
                            var newDate;
                            newDate = _this.currentDate().clone().month(newValue);
                            if (!newDate.isSame(_this.currentDate(), 'month')) {
                                return _this.currentDate(newDate);
                            }
                        };
                    })(this),
                    pure: true
                });
                this.selectedYear = ko.computed({
                    read: (function (_this) {
                        return function () {
                            return _this.currentDate().year();
                        };
                    })(this),
                    write: (function (_this) {
                        return function (newValue) {
                            var newDate;
                            newDate = _this.currentDate().clone().year(newValue);
                            if (!newDate.isSame(_this.currentDate(), 'year')) {
                                return _this.currentDate(newDate);
                            }
                        };
                    })(this),
                    pure: true
                });
                this.selectedDecade = ko.computed({
                    read: (function (_this) {
                        return function () {
                            return _this.firstYearOfDecade(_this.currentDate()).year();
                        };
                    })(this),
                    write: (function (_this) {
                        return function (newValue) {
                            var newDate, newYear, offset;
                            offset = (_this.currentDate().year() - _this.selectedDecade()) % 9;
                            newYear = newValue + offset;
                            newDate = _this.currentDate().clone().year(newYear);
                            if (!newDate.isSame(_this.currentDate(), 'year')) {
                                return _this.currentDate(newDate);
                            }
                        };
                    })(this),
                    pure: true
                });
            }

            CalendarHeaderView.prototype.clickPrevButton = function () {
                return this.currentDate(this.prevDate());
            };

            CalendarHeaderView.prototype.clickNextButton = function () {
                return this.currentDate(this.nextDate());
            };

            CalendarHeaderView.prototype.prevArrowCss = function () {
                var date;
                date = this.firstDate().clone().subtract(1, 'millisecond');
                return {
                    'arrow-hidden': !this.currentDate.isWithinBoundaries(date)
                };
            };

            CalendarHeaderView.prototype.nextArrowCss = function () {
                var cols, date, ref, rows;
                ref = this.period.dimentions(), cols = ref[0], rows = ref[1];
                date = this.firstDate().clone().add(cols * rows, this.period());
                return {
                    'arrow-hidden': !this.currentDate.isWithinBoundaries(date)
                };
            };

            CalendarHeaderView.prototype.monthOptions = function () {
                var j, maxMonth, minMonth, results;
                minMonth = this.currentDate.minBoundary().isSame(this.currentDate(), 'year') ? this.currentDate.minBoundary().month() : 0;
                maxMonth = this.currentDate.maxBoundary().isSame(this.currentDate(), 'year') ? this.currentDate.maxBoundary().month() : 11;
                return (function () {
                    results = [];
                    for (var j = minMonth; minMonth <= maxMonth ? j <= maxMonth : j >= maxMonth; minMonth <= maxMonth ? j++ : j--) { results.push(j); }
                    return results;
                }).apply(this);
            };

            CalendarHeaderView.prototype.yearOptions = function () {
                var j, ref, ref1, results;
                return (function () {
                    results = [];
                    for (var j = ref = this.currentDate.minBoundary().year(), ref1 = this.currentDate.maxBoundary().year(); ref <= ref1 ? j <= ref1 : j >= ref1; ref <= ref1 ? j++ : j--) { results.push(j); }
                    return results;
                }).apply(this);
            };

            CalendarHeaderView.prototype.decadeOptions = function () {
                return ArrayUtils.uniqArray(this.yearOptions().map((function (_this) {
                    return function (year) {
                        var momentObj;
                        momentObj = MomentUtil.tz([year], _this.timeZone());
                        return _this.firstYearOfDecade(momentObj).year();
                    };
                })(this)));
            };

            CalendarHeaderView.prototype.monthSelectorAvailable = function () {
                var ref;
                return (ref = this.period()) === 'day' || ref === 'week';
            };

            CalendarHeaderView.prototype.yearSelectorAvailable = function () {
                return this.period() !== 'year';
            };

            CalendarHeaderView.prototype.decadeSelectorAvailable = function () {
                return this.period() === 'year';
            };

            CalendarHeaderView.prototype.monthFormatter = function (x) {
                return moment.utc([2015, x]).format('MMM');
            };

            CalendarHeaderView.prototype.yearFormatter = function (x) {
                return moment.utc([x]).format('YYYY');
            };

            CalendarHeaderView.prototype.decadeFormatter = function (from) {
                var cols, ref, rows, to;
                ref = Period.dimentions('year'), cols = ref[0], rows = ref[1];
                to = from + cols * rows - 1;
                return from + " – " + to;
            };

            return CalendarHeaderView;

        })();

        CalendarView = (function () {
            function CalendarView(mainView, dateSubscribable, type) {
                this.cssForDate = bind(this.cssForDate, this);
                this.eventsForDate = bind(this.eventsForDate, this);
                this.formatDateTemplate = bind(this.formatDateTemplate, this);
                this.tableValues = bind(this.tableValues, this);
                this.inRange = bind(this.inRange, this);
                this.period = mainView.period;
                this.single = mainView.single;
                this.timeZone = mainView.timeZone;
                this.locale = mainView.locale;
                this.startDate = mainView.startDate;
                this.endDate = mainView.endDate;
                this.type = type;
                this.label = mainView.locale[type + "Label"] || '';
                this.hoverDate = ko.observable(null);
                this.activeDate = dateSubscribable;
                this.currentDate = dateSubscribable.clone();
                this.inputDate = ko.computed({
                    read: (function (_this) {
                        return function () {
                            return (_this.hoverDate() || _this.activeDate()).format(_this.locale.inputFormat);
                        };
                    })(this),
                    write: (function (_this) {
                        return function (newValue) {
                            var newDate;
                            newDate = MomentUtil.tz(newValue, _this.locale.inputFormat, _this.timeZone());
                            if (newDate.isValid()) {
                                return _this.activeDate(newDate);
                            }
                        };
                    })(this),
                    pure: true
                });
                this.firstDate = ko.pureComputed((function (_this) {
                    return function () {
                        var date, firstDayOfMonth;
                        date = _this.currentDate().clone().startOf(_this.period.scale());
                        switch (_this.period()) {
                            case 'day':
                            case 'week':
                                firstDayOfMonth = date.clone();
                                date.weekday(0);
                                if (date.isAfter(firstDayOfMonth) || date.isSame(firstDayOfMonth, 'day')) {
                                    date.subtract(1, 'week');
                                }
                                break;
                            case 'year':
                                date = _this.firstYearOfDecade(date);
                        }
                        return date;
                    };
                })(this));
                this.activeDate.subscribe((function (_this) {
                    return function (newValue) {
                        return _this.currentDate(newValue);
                    };
                })(this));
                this.headerView = new CalendarHeaderView(this);
            }

            CalendarView.prototype.calendar = function () {
                var col, cols, date, iterator, j, ref, ref1, results, row, rows;
                ref = this.period.dimentions(), cols = ref[0], rows = ref[1];
                iterator = new MomentIterator(this.firstDate(), this.period());
                results = [];
                for (row = j = 1, ref1 = rows; 1 <= ref1 ? j <= ref1 : j >= ref1; row = 1 <= ref1 ? ++j : --j) {
                    results.push((function () {
                        var l, ref2, results1;
                        results1 = [];
                        for (col = l = 1, ref2 = cols; 1 <= ref2 ? l <= ref2 : l >= ref2; col = 1 <= ref2 ? ++l : --l) {
                            date = iterator.next();
                            if (this.type === 'end') {
                                results1.push(date.endOf(this.period()));
                            } else {
                                results1.push(date.startOf(this.period()));
                            }
                        }
                        return results1;
                    }).call(this));
                }
                return results;
            };

            CalendarView.prototype.weekDayNames = function () {
                return moment.weekdaysMin();
            };

            CalendarView.prototype.inRange = function (date) {
                return date.isAfter(this.startDate(), this.period()) && date.isBefore(this.endDate(), this.period()) || (date.isSame(this.startDate(), this.period()) || date.isSame(this.endDate(), this.period()));
            };

            CalendarView.prototype.tableValues = function (date) {
                var format, months, quarter;
                format = this.period.format();
                switch (this.period()) {
                    case 'day':
                    case 'month':
                    case 'year':
                        return [
                            {
                                html: date.format(format)
                            }
                        ];
                    case 'week':
                        date = date.clone().startOf(this.period());
                        return MomentIterator.array(date, 7, 'day').map((function (_this) {
                            return function (date) {
                                return {
                                    html: date.format(format),
                                    css: {
                                        'week-day': true,
                                        unavailable: _this.cssForDate(date, true).unavailable
                                    }
                                };
                            };
                        })(this));
                    case 'quarter':
                        quarter = date.format(format);
                        date = date.clone().startOf('quarter');
                        months = MomentIterator.array(date, 3, 'month').map(function (date) {
                            return date.format('MMM');
                        });
                        return [
                            {
                                html: quarter + "<br><span class='months'>" + (months.join(", ")) + "</span>"
                            }
                        ];
                }
            };

            CalendarView.prototype.formatDateTemplate = function (date) {
                return {
                    nodes: $("<div>" + (this.formatDate(date)) + "</div>").children()
                };
            };

            CalendarView.prototype.eventsForDate = function (date) {
                return {
                    click: (function (_this) {
                        return function () {
                            if (_this.activeDate.isWithinBoundaries(date)) {
                                return _this.activeDate(date);
                            }
                        };
                    })(this),
                    mouseenter: (function (_this) {
                        return function () {
                            if (_this.activeDate.isWithinBoundaries(date)) {
                                return _this.hoverDate(_this.activeDate.fit(date));
                            }
                        };
                    })(this),
                    mouseleave: (function (_this) {
                        return function () {
                            return _this.hoverDate(null);
                        };
                    })(this)
                };
            };

            CalendarView.prototype.cssForDate = function (date, periodIsDay) {
                var differentMonth, inRange, obj1, onRangeEnd, withinBoundaries;
                onRangeEnd = date.isSame(this.activeDate(), this.period());
                withinBoundaries = this.activeDate.isWithinBoundaries(date);
                periodIsDay || (periodIsDay = this.period() === 'day');
                differentMonth = !date.isSame(this.currentDate(), 'month');
                inRange = this.inRange(date);
                return (
                    obj1 = {
                        "in-range": !this.single() && (inRange || onRangeEnd)
                    },
                    obj1[this.type + "-date"] = onRangeEnd,
                    obj1["clickable"] = withinBoundaries,
                    obj1["out-of-boundaries"] = !withinBoundaries,
                    obj1["unavailable"] = periodIsDay && differentMonth,
                    obj1
                );
            };

            CalendarView.prototype.firstYearOfDecade = function (date) {
                var currentYear, firstYear, offset, year;
                currentYear = MomentUtil.tz(moment(), this.timeZone()).year();
                firstYear = currentYear - 4;
                offset = Math.floor((date.year() - firstYear) / 9);
                year = firstYear + offset * 9;
                return MomentUtil.tz([year], this.timeZone());
            };

            return CalendarView;

        })();

        DateRangePickerView = (function () {
            function DateRangePickerView(options) {
                var endDate, ref, startDate, wrapper;
                if (options == null) {
                    options = {};
                }
                this.outsideClick = bind(this.outsideClick, this);
                this.setDateRange = bind(this.setDateRange, this);
                new Config(options).extend(this);
                this.startCalendar = new CalendarView(this, this.startDate, 'start');
                this.endCalendar = new CalendarView(this, this.endDate, 'end');
                this.startDateInput = this.startCalendar.inputDate;
                this.endDateInput = this.endCalendar.inputDate;
                this.dateRange = ko.observable([this.startDate(), this.endDate()]);
                this.startDate.subscribe((function (_this) {
                    return function (newValue) {
                        if (_this.single()) {
                            _this.endDate(newValue.clone().endOf(_this.period()));
                            _this.updateDateRange();
                            return _this.close();
                        } else {
                            if (_this.endDate().isSame(newValue)) {
                                _this.endDate(_this.endDate().clone().endOf(_this.period()));
                            }
                            if (_this.standalone()) {
                                return _this.updateDateRange();
                            }
                        }
                    };
                })(this));
                this.style = ko.observable({});
                if (this.callback) {
                    this.dateRange.subscribe((function (_this) {
                        return function (newValue) {
                            var endDate, startDate;
                            startDate = newValue[0], endDate = newValue[1];
                            return _this.callback(startDate.clone(), endDate.clone(), _this.period());
                        };
                    })(this));
                    if (this.forceUpdate) {
                        ref = this.dateRange(), startDate = ref[0], endDate = ref[1];
                        this.callback(startDate.clone(), endDate.clone(), this.period());
                    }
                }
                if (this.anchorElement) {
                    wrapper = $("<div data-bind=\"stopBinding: true\"></div>").appendTo(this.parentElement);
                    this.containerElement = $(this.constructor.template).appendTo(wrapper);
                    ko.applyBindings(this, this.containerElement.get(0));
                    this.anchorElement.click((function (_this) {
                        return function () {
                            _this.updatePosition();
                            return _this.toggle();
                        };
                    })(this));
                    if (!this.standalone()) {
                        $(document).on('mousedown.daterangepicker', this.outsideClick).on('touchend.daterangepicker', this.outsideClick).on('click.daterangepicker', '[data-toggle=dropdown]', this.outsideClick).on('focusin.daterangepicker', this.outsideClick);
                    }
                }
                if (this.opened()) {
                    this.updatePosition();
                }
            }

            DateRangePickerView.prototype.periodProxy = Period;

            DateRangePickerView.prototype.calendars = function () {
                if (this.single()) {
                    return [this.startCalendar];
                } else {
                    return [this.startCalendar, this.endCalendar];
                }
            };

            DateRangePickerView.prototype.updateDateRange = function () {
                return this.dateRange([this.startDate(), this.endDate()]);
            };

            DateRangePickerView.prototype.cssClasses = function () {
                var j, len, obj, period, ref;
                obj = {
                    single: this.single(),
                    opened: this.standalone() || this.opened(),
                    expanded: this.standalone() || this.single() || this.expanded(),
                    standalone: this.standalone(),
                    'orientation-left': this.orientation() === 'left',
                    'orientation-right': this.orientation() === 'right',
                    'hide-periods': this.periods().length === 1
                };
                ref = Period.allPeriods;
                for (j = 0, len = ref.length; j < len; j++) {
                    period = ref[j];
                    obj[period + "-period"] = period === this.period();
                }
                return obj;
            };

            DateRangePickerView.prototype.isActivePeriod = function (period) {
                return this.period() === period;
            };

            DateRangePickerView.prototype.isActiveDateRange = function (dateRange) {
                var dr, j, len, ref;
                if (dateRange.constructor === CustomDateRange) {
                    ref = this.ranges;
                    for (j = 0, len = ref.length; j < len; j++) {
                        dr = ref[j];
                        if (dr.constructor !== CustomDateRange && this.isActiveDateRange(dr)) {
                            return false;
                        }
                    }
                    return true;
                } else {
                    return this.startDate().isSame(dateRange.startDate, 'day') && this.endDate().isSame(dateRange.endDate, 'day');
                }
            };

            DateRangePickerView.prototype.inputFocus = function () {
                return this.expanded(true);
            };

            DateRangePickerView.prototype.setPeriod = function (period) {
                this.period(period);
                return this.expanded(true);
            };

            DateRangePickerView.prototype.setDateRange = function (dateRange) {
                if (dateRange.constructor === CustomDateRange) {
                    return this.expanded(true);
                } else {
                    this.expanded(false);
                    this.close();
                    this.period('day');
                    this.startDate(dateRange.startDate);
                    this.endDate(dateRange.endDate);
                    return this.updateDateRange();
                }
            };

            DateRangePickerView.prototype.applyChanges = function () {
                this.close();
                return this.updateDateRange();
            };

            DateRangePickerView.prototype.cancelChanges = function () {
                return this.close();
            };

            DateRangePickerView.prototype.open = function () {
                return this.opened(true);
            };

            DateRangePickerView.prototype.close = function () {
                if (!this.standalone()) {
                    return this.opened(false);
                }
            };

            DateRangePickerView.prototype.toggle = function () {
                if (this.opened()) {
                    return this.close();
                } else {
                    return this.open();
                }
            };

            DateRangePickerView.prototype.updatePosition = function () {
                var parentOffset, parentRightEdge, style;
                if (this.standalone()) {
                    return;
                }
                parentOffset = {
                    top: 0,
                    left: 0
                };
                parentRightEdge = $(window).width();
                if (!this.parentElement.is('body')) {
                    parentOffset = {
                        top: this.parentElement.offset().top - this.parentElement.scrollTop(),
                        left: this.parentElement.offset().left - this.parentElement.scrollLeft()
                    };
                    parentRightEdge = this.parentElement.get(0).clientWidth + this.parentElement.offset().left;
                }
                style = {
                    top: (this.anchorElement.offset().top + this.anchorElement.outerHeight() - parentOffset.top) + 'px',
                    left: 'auto',
                    right: 'auto'
                };
                switch (this.orientation()) {
                    case 'left':
                        if (this.containerElement.offset().left < 0) {
                            style.left = '9px';
                        } else {
                            style.right = (parentRightEdge - (this.anchorElement.offset().left) - this.anchorElement.outerWidth()) + 'px';
                        }
                        break;
                    default:
                        if (this.containerElement.offset().left + this.containerElement.outerWidth() > $(window).width()) {
                            style.right = '0';
                        } else {
                            style.left = (this.anchorElement.offset().left - parentOffset.left) + 'px';
                        }
                }
                return this.style(style);
            };

            DateRangePickerView.prototype.outsideClick = function (event) {
                var target;
                target = $(event.target);
                if (!(event.type === 'focusin' || target.closest(this.anchorElement).length || target.closest(this.containerElement).length || target.closest('.calendar').length)) {
                    return this.close();
                }
            };

            return DateRangePickerView;

        })();

        DateRangePickerView.template = '<div class="daterangepicker" data-bind="css: $data.cssClasses(), style: $data.style()"> <div class="controls"> <ul class="periods" data-bind="foreach: $data.periods"> <li class="period" data-bind="css: {active: $parent.isActivePeriod($data)}, text: $parent.periodProxy.title($data), click: function(){ $parent.setPeriod($data); }"></li> </ul> <ul class="ranges" data-bind="foreach: $data.ranges"> <li class="range" data-bind="css: {active: $parent.isActiveDateRange($data)}, text: $data.title, click: function(){ $parent.setDateRange($data); }"></li> </ul> <form data-bind="submit: $data.applyChanges"> <div class="custom-range-inputs"> <input type="text" data-bind="value: $data.startDateInput, event: {focus: $data.inputFocus}" /> <input type="text" data-bind="value: $data.endDateInput, event: {focus: $data.inputFocus}" /> </div> <div class="custom-range-buttons"> <button class="apply-btn" type="submit" data-bind="text: $data.locale.applyButtonTitle, click: $data.applyChanges"></button> <button class="cancel-btn" data-bind="text: $data.locale.cancelButtonTitle, click: $data.cancelChanges"></button> </div> </form> </div> <!-- ko foreach: $data.calendars() --> <div class="calendar"> <div class="calendar-title" data-bind="text: $data.label"></div> <div class="calendar-header" data-bind="with: $data.headerView"> <div class="arrow" data-bind="css: $data.prevArrowCss()"> <button data-bind="click: $data.clickPrevButton"><span class="arrow-left"></span></button> </div> <div class="calendar-selects"> <select class="month-select" data-bind="options: $data.monthOptions(), optionsText: $data.monthFormatter, valueAllowUnset: true, value: $data.selectedMonth, css: {hidden: !$data.monthSelectorAvailable()}"></select> <select class="year-select" data-bind="options: $data.yearOptions(), optionsText: $data.yearFormatter, valueAllowUnset: true, value: $data.selectedYear, css: {hidden: !$data.yearSelectorAvailable()}"></select> <select class="decade-select" data-bind="options: $data.decadeOptions(), optionsText: $data.decadeFormatter, valueAllowUnset: true, value: $data.selectedDecade, css: {hidden: !$data.decadeSelectorAvailable()}"></select> </div> <div class="arrow" data-bind="css: $data.nextArrowCss()"> <button data-bind="click: $data.clickNextButton"><span class="arrow-right"></span></button> </div> </div> <div class="calendar-table"> <!-- ko if: $parent.periodProxy.showWeekDayNames($data.period()) --> <div class="table-row weekdays" data-bind="foreach: $data.weekDayNames()"> <div class="table-col"> <div class="table-value-wrapper"> <div class="table-value" data-bind="text: $data"></div> </div> </div> </div> <!-- /ko --> <!-- ko foreach: $data.calendar() --> <div class="table-row" data-bind="foreach: $data"> <div class="table-col" data-bind="event: $parents[1].eventsForDate($data), css: $parents[1].cssForDate($data)"> <div class="table-value-wrapper" data-bind="foreach: $parents[1].tableValues($data)"> <div class="table-value" data-bind="html: $data.html, css: $data.css"></div> </div> </div> </div> <!-- /ko --> </div> </div> <!-- /ko --> </div>';

        $.extend($.fn.daterangepicker, {
            ArrayUtils: ArrayUtils,
            MomentIterator: MomentIterator,
            MomentUtil: MomentUtil,
            Period: Period,
            Config: Config,
            DateRange: DateRange,
            AllTimeDateRange: AllTimeDateRange,
            CustomDateRange: CustomDateRange,
            DateRangePickerView: DateRangePickerView,
            CalendarView: CalendarView,
            CalendarHeaderView: CalendarHeaderView
        });

    }).call(this);

    ko.applyBindings({
        dateRange: ko.observable()
    })
</script>